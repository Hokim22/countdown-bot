# カウントダウンbotシステム要件定義

## 📋 機能要件（Functional Requirements）

### 1. カウントダウン機能
- **FR-001**: 設定された目標日までの残り日数を自動計算する
- **FR-002**: 毎日定時（朝7:30）に自動実行する
- **FR-003**: 目標日当日は「本日が試験日です」メッセージを表示する
- **FR-004**: 目標日経過後は「お疲れ様でした」メッセージを表示する

### 2. キャラクター応援機能
- **FR-005**: 8種類のキャラクターからランダムに選択する
  - 天真爛漫な友人、毒舌系フリーター、優しいお姉さん、推しのアイドル
  - 未来の自分、競い合うライバル、守護霊、温かい家族
- **FR-006**: 選択されたキャラクター名をメッセージに表示する
- **FR-007**: キャラクター別の個性的な口調でメッセージを生成する

### 3. AI メッセージ生成機能
- **FR-008**: Amazon Bedrock（Claude 3 Haiku）を使用してメッセージを生成する
- **FR-009**: キャラクター別の詳細プロンプトに基づいて文章を作成する
- **FR-010**: 150文字程度の実用的なアドバイスを含むメッセージを生成する
- **FR-011**: AI生成失敗時はローカル定義メッセージを使用する

### 4. 通知機能
- **FR-012**: Slack Webhook APIを使用してメッセージを投稿する
- **FR-013**: 指定されたSlackチャンネルに投稿する
- **FR-014**: botのユーザー名とアイコンを設定する

### 5. データ管理機能
- **FR-015**: 試験情報（名前、日付、Webhook URL）をDynamoDBに保存する
- **FR-016**: 複数の試験を同時に管理できる
- **FR-017**: 試験情報の追加・更新・削除ができる

## ⚙️ 非機能要件（Non-Functional Requirements）

### 1. 性能要件（Performance）
- **NFR-001**: メッセージ生成から投稿まで30秒以内に完了する
- **NFR-002**: DynamoDBアクセスは10秒以内に完了する
- **NFR-003**: 同時に10件までの試験を処理できる

### 2. 可用性要件（Availability）
- **NFR-004**: システム稼働率99%以上を維持する
- **NFR-005**: AWS障害時も自動復旧する（サーバーレス特性）
- **NFR-006**: 単一障害点を持たない構成とする

### 3. 拡張性要件（Scalability）
- **NFR-007**: 試験数の増加に自動対応する（DynamoDB Auto Scaling）
- **NFR-008**: Lambda関数は自動スケーリングする
- **NFR-009**: 将来的なキャラクター追加に対応できる

### 4. セキュリティ要件（Security）
- **NFR-010**: IAMロールによる最小権限アクセス制御
- **NFR-011**: Slack Webhook URLを暗号化して保存する
- **NFR-012**: AWSサービス間通信はHTTPS/TLSを使用する
- **NFR-013**: 認証情報をハードコードしない

### 5. 運用性要件（Operability）
- **NFR-014**: CloudWatchによるログ監視機能
- **NFR-015**: エラー発生時の自動アラート機能
- **NFR-016**: 設定変更時のコード修正不要
- **NFR-017**: バックアップ・復旧機能（DynamoDB Point-in-time Recovery）

### 6. コスト要件（Cost）
- **NFR-018**: 月額運用コスト10ドル以下
- **NFR-019**: 従量課金モデルによるコスト最適化
- **NFR-020**: 無料枠を最大限活用する

### 7. 保守性要件（Maintainability）
- **NFR-021**: サーバーレス構成による管理負荷最小化
- **NFR-022**: コードの可読性と保守性を確保
- **NFR-023**: 設定とロジックの分離
- **NFR-024**: バージョン管理とデプロイ自動化

### 8. 互換性要件（Compatibility）
- **NFR-025**: Slack Webhook API v1との互換性
- **NFR-026**: AWS東京リージョン（ap-northeast-1）での動作
- **NFR-027**: Node.js 18.x ランタイム対応

### 9. 信頼性要件（Reliability）
- **NFR-028**: メッセージ送信失敗時のリトライ機能
- **NFR-029**: データ整合性の保証
- **NFR-030**: 障害時の適切なエラーハンドリング

## 📊 要件の優先度

### 高優先度（Must Have）
- カウントダウン機能（FR-001〜004）
- 通知機能（FR-012〜014）
- 基本的な非機能要件（NFR-001, 004, 010, 018）

### 中優先度（Should Have）
- キャラクター機能（FR-005〜007）
- AI生成機能（FR-008〜011）
- 運用性要件（NFR-014〜017）

### 低優先度（Could Have）
- 高度な拡張性（NFR-007〜009）
- 詳細な監視機能（NFR-015）

## 🎯 成功基準

### 機能面
- ✅ 毎日定時にメッセージが投稿される
- ✅ キャラクターが日替わりで変わる
- ✅ メッセージ内容が毎回異なる

### 非機能面
- ✅ 月額コスト10ドル以下
- ✅ 管理作業ゼロで運用
- ✅ 99%以上の稼働率