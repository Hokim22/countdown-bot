# カウントダウンbotシステム構成図

## システム概要
```
┌─────────────────────────────────────────────────────────────────┐
│                    カウントダウンbotシステム                      │
│                   〜試験・発表応援AI bot〜                       │
└─────────────────────────────────────────────────────────────────┘
```

## アーキテクチャ図

```
┌──────────────────┐    ┌──────────────────┐    ┌──────────────────┐
│   EventBridge    │    │      Lambda      │    │    DynamoDB      │
│                  │    │                  │    │                  │
│  ⏰ 毎日7:30     │───▶│  countdown-bot   │───▶│ exam-countdown   │
│  cron実行        │    │                  │    │                  │
│                  │    │ ・カウントダウン │    │ ・試験データ     │
└──────────────────┘    │ ・キャラ選択     │    │ ・Webhook URL    │
                        │ ・メッセージ生成 │    │ ・キャラ設定     │
                        └─────────┬────────┘    └──────────────────┘
                                  │
                        ┌─────────▼────────┐
                        │     Bedrock      │
                        │                  │
                        │ Claude 3 Haiku   │
                        │ AI文章生成       │
                        │ キャラ別プロンプト│
                        └─────────┬────────┘
                                  │
                        ┌─────────▼────────┐
                        │      Slack       │
                        │                  │
                        │  Webhook API     │
                        │  メッセージ投稿  │
                        │                  │
                        └──────────────────┘
```

## データフロー

```
1. EventBridge (毎日7:30)
   ↓
2. Lambda関数起動
   ↓
3. DynamoDBから試験データ取得
   ↓
4. 日数計算 & キャラクター選択
   ↓
5. Bedrock AI でメッセージ生成
   ↓
6. Slack Webhook でメッセージ投稿
```

## 技術スタック

| 分類 | 技術 | 役割 |
|------|------|------|
| **スケジューラ** | Amazon EventBridge | 定期実行（毎日7:30） |
| **コンピュート** | AWS Lambda | メイン処理ロジック |
| **データベース** | Amazon DynamoDB | 試験データ保存 |
| **AI** | Amazon Bedrock | 文章生成（Claude 3 Haiku） |
| **通知** | Slack Webhook | メッセージ投稿 |
| **権限管理** | AWS IAM | アクセス制御 |

## 主要機能

### 🎭 キャラクターシステム
- 8種類のキャラクターからランダム選択
- 天真爛漫な友人 / 毒舌系フリーター / 優しいお姉さん
- 推しのアイドル / 未来の自分 / ライバル / 守護霊 / 温かい家族

### 🤖 AI生成メッセージ
- キャラクター別の詳細プロンプト
- 150文字程度の実用的アドバイス
- 毎回異なる表現で飽きない

### 📊 運用コスト
- **月額**: 約5-9ドル
- **サーバーレス**: 管理不要
- **従量課金**: 使った分だけ

## セキュリティ

```
┌──────────────────┐
│   IAM Role       │
│                  │
│ ・Lambda実行権限 │
│ ・DynamoDB R/W   │
│ ・Bedrock呼出    │
│ ・CloudWatch Log │
└──────────────────┘
```

## 監視・ログ

```
┌──────────────────┐
│  CloudWatch      │
│                  │
│ ・実行ログ       │
│ ・エラー監視     │
│ ・メトリクス     │
└──────────────────┘
```